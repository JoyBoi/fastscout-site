---
import { getSupabaseServerClient } from "../lib/supabase";
const { title = "FastScout" } = Astro.props as { title?: string };
const supabase = getSupabaseServerClient(Astro);
const { data } = await supabase.auth.getUser();
const signedIn = !!data.user;
---
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <link rel="icon" href="/logo.png" />
    <style is:inline>
      :root {
        color-scheme: light dark;
        --color-bg: #ffffff;
        --color-text: #0f172a;
        --color-muted: #6b7280;
        --color-primary: #3b82f6;
        --color-primary-600: #2563eb;
        --color-border: #e5e7eb;
        --radius: 12px;
        --shadow: 0 6px 18px rgba(17, 24, 39, 0.08);
        --space-1: 8px;
        --space-2: 12px;
        --space-3: 16px;
        --space-4: 24px;
        --space-5: 32px;
      }
      @media (prefers-color-scheme: dark) {
        :root {
          --color-bg: #0b1220;
          --color-text: #e5e7eb;
          --color-muted: #9ca3af;
          --color-border: #1f2937;
          --shadow: 0 8px 26px rgba(0, 0, 0, 0.35);
        }
      }
      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        margin: 0;
        background: var(--color-bg);
        color: var(--color-text);
      }
      a { color: inherit; }
      header {
        position: sticky;
        top: 0;
        z-index: 50;
        display:flex;
        align-items:center;
        justify-content:space-between;
        padding: var(--space-2) var(--space-4);
        border-bottom: 1px solid var(--color-border);
        backdrop-filter: saturate(140%) blur(8px);
        background: color-mix(in oklab, var(--color-bg) 88%, transparent);
      }
      .logo {
        font-weight: 700;
        font-size: 18px;
        text-decoration: none;
      }
      nav a {
        margin-right: var(--space-3);
        text-decoration: none;
        padding: 8px 10px;
        border-radius: 8px;
      }
      nav a:hover { background: color-mix(in oklab, var(--color-primary) 16%, transparent); color: #fff; }
      .container {
        max-width: 1120px;
        margin: 0 auto;
        padding: var(--space-4);
      }
      .section { padding: var(--space-5) 0; }
      .grid { display: grid; gap: var(--space-4); }
      .grid-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .grid-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
      .card {
        border: 1px solid var(--color-border);
        border-radius: var(--radius);
        padding: var(--space-4);
        box-shadow: var(--shadow);
        background: color-mix(in oklab, var(--color-bg) 95%, #fff);
      }
      .badge {
        display:inline-block;
        font-size: 12px;
        padding: 4px 8px;
        border-radius: 999px;
        background: color-mix(in oklab, var(--color-primary) 18%, transparent);
        color: #fff;
      }
      .muted { color: var(--color-muted); }
      .status-dot {
        display:inline-block;
        width: 10px; height: 10px;
        border-radius: 999px;
        margin-right: 6px;
        background: #16a34a;
      }
      .status-dot.inactive { background: #dc2626; }
      .feature-list { list-style: none; padding: 0; margin: 0; }
      .feature-list li { padding-left: 22px; position: relative; margin: 8px 0; }
      .feature-list li::before {
        content: "âœ“";
        position: absolute; left: 0; top: 0;
        color: var(--color-primary);
      }
      .plan { position: relative; }
      .plan--featured {
        border: 1px solid var(--color-primary);
        box-shadow: 0 12px 28px rgba(59,130,246,.25);
      }
      .table { list-style: none; padding: 0; margin: 0; }
      .table li {
        display:flex;
        align-items:center;
        justify-content:space-between;
        border-bottom: 1px solid var(--color-border);
        padding: 10px 0;
      }
      .btn {
        display:inline-block;
        padding:10px 16px;
        border-radius:10px;
        border:1px solid var(--color-border);
        text-decoration:none;
        transition: transform 200ms ease, background 200ms ease, box-shadow 200ms ease, color 200ms ease;
        background: color-mix(in oklab, var(--color-bg) 92%, #fff);
      }
      .btn:hover { transform: translateY(-1px); box-shadow: var(--shadow); }
      .btn:focus-visible {
        outline: 3px solid color-mix(in oklab, var(--color-primary) 50%, transparent);
        outline-offset: 2px;
      }
      .btn-primary {
        background: var(--color-primary);
        color: white;
        border-color: var(--color-primary);
      }
      .btn-primary:hover { background: var(--color-primary-600); }
      .btn-outline {
        background: transparent;
        color: var(--color-primary);
        border-color: var(--color-primary);
      }
      .lead { font-size: 18px; color: var(--color-muted); }
      .hero {
        display: grid;
        grid-template-columns: 1fr;
        align-items: center;
        gap: var(--space-4);
      }
      .hero h1 { font-size: 38px; line-height: 1.1; margin: 0; }
      .hero-actions { display:flex; gap: var(--space-3); flex-wrap: wrap; }
      .feature {
        display:flex;
        gap: var(--space-3);
        align-items:flex-start;
      }
      .feature .icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        background: color-mix(in oklab, var(--color-primary) 18%, transparent);
      }
      .fade-in { animation: fade-in 500ms ease both; }
      @keyframes fade-in { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
      @media (max-width: 960px) {
        .grid-2 { grid-template-columns: 1fr; }
        .grid-3 { grid-template-columns: 1fr; }
        .hero h1 { font-size: 32px; }
      }
      @media (prefers-reduced-motion: reduce) {
        .fade-in { animation: none; }
        .btn { transition: none; }
      }
    </style>
    <script src="https://js.stripe.com/v3" async></script>
  </head>
  <body>
    <header>
      <div><a class="logo" href="/">FastScout</a></div>
      <nav>
        <a href="/pricing">Pricing</a>
        {
          signedIn ? (
            <a href="/dashboard">Dashboard</a>
          ) : (
            <a class="btn btn-primary" href="/auth">Sign In</a>
          )
        }
      </nav>
    </header>
    <main class="container section">
      <slot />
    </main>
  </body>
  
</html>
